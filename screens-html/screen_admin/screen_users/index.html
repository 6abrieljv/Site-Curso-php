<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script src="https://cdn.tailwindcss.com"></script>

    <link href="https://fonts.googleapis.com/css2?family=Pixelify+Sans:wght@400..700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap">

    <script src="https://unpkg.com/ionicons@4.5.10-0/dist/ionicons.js"></script>

    <link rel="shortcut icon" type="image/jpg" href="../../../public/assets/img/logos/logo.png"/>
    
    <title>Admin - Gerenciar Usuários</title>

</head>

<body class="font-['Pixelify_Sans'] bg-[#F5F4F4]">
    
    <header class="bg-[#001934]">
        <nav class="flex justify-between items-center w-[95%] m-auto">
            <div>
                <a href=""><img class="w-16 p-1" src="../../../public/assets/img/logos/logo.png" alt="Logo"></a>
            </div>
            <div
                class="nav-links duration-500 md:static absolute bg-[#001934] md:min-h-fit min-h-[40vh] left-0 top-[-100%] md:w-auto w-full flex items-center px-5">
                <ul class="flex md:flex-row flex-col md:items-center md:gap-[6vw] gap-6 text-white text-lg p-4">
                    <li><a class="hover:text-xl hover:underline duration-300" href="#">Home</a></li>
                    <li><a class="hover:text-xl hover:underline duration-300" href="#">Noticias</a></li>
                    <li><a class="hover:text-xl hover:underline duration-300" href="#">PodPink</a></li>
                    <li><a class="hover:text-xl hover:underline duration-300" href="#">LTD</a></li>
                    <li><a class="hover:text-xl hover:underline duration-300" href="../screen_educadores/index.html">Educadores</a></li>
                    <li><a class="hover:text-xl hover:underline duration-300" href="#">Atlética</a></li>
                    <li><a class="hover:text-xl hover:underline duration-300" href="#">Admin</a></li>
                </ul>
            </div>
            <div class="flex items-center gap-6">
                <button
                    class=" text-lg text-white px-5 py-2 rounded-3xl hover:text-xl cursor-pointer duration-300 ease-out hover:underline active:text-[#001934]">
                    Entrar
                </button>
                <ion-icon onclick="onToggleMenu(this)" name="menu"
                    class="text-3xl text-white cursor-pointer md:hidden"></ion-icon>
            </div>
        </nav>
    </header>

  <div class="flex min-h-screen">

    <aside class="w-[250px] bg-[#012145] shadow-md p-6">
        <nav class="space-y-4 text-white">
          <a href="../screen_dashboard/index.html" class="block text-lg  hover:text-xl hover:underline duration-300 ">Dashboard</a>
          <a href="../screen_users/index.html" class="block text-lg  hover:text-xl hover:underline duration-300 font-medium">Usuários</a>
          <a href="../screen_noticias/index.html" class="block text-lg  hover:text-xl hover:underline duration-300">Notícias</a>
          <a href="../screen_educadores/index.html" class="block text-lg  hover:text-xl hover:underline duration-300">Educadores</a>
        </nav>
    </aside>

    <main class="flex-1 p-6 ">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold text-gray-800">Gerenciar Usuários</h2>
        <select 
                name="" id=""
                class=" bg-white border border-gray-300 text-black py-3 px-5 text-sm rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                    <option value="allFilter">Todos</option>
                    <option value="usersFilter">Usuários</option>
                    <option value="adminFilter">Admins</option>
                </select>
      </div>

      <div class="bg-white shadow-md rounded-lg overflow-x-auto flex-grow grow">
        <table class="w-full text-left">
          <thead class="bg-gray-200">
            <tr>
              <th class="p-4">ID</th>
              <th class="p-4">Nome</th>
              <th class="p-4">Cargo</th>
              <th class="p-4">Data de Cadastro</th>
              <th class="p-4">Ações</th>
            </tr>
          </thead>
          <tbody>
            <tr class="border-b hover:bg-gray-50">
                <td class="p-4 educator-table-id">1</td>
                <td class="p-4 educator-table-name">Brunera</td>
                <td class="p-4 educator-table-role">brunera@gmail.com</td>
                <td class="p-4 educator-table-date">26/05/2025</td>
                <td class="p-4 flex space-x-2">
                <button class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded"
                        data-id="1"
                        data-name="Prof. Dr. Exemplo Silva"
                        data-role="Coordenador de Curso"
                        data-bio="Doutor em Ciências da Computação com vasta experiência em desenvolvimento de software e inteligência artificial. Entusiasta de novas tecnologias e metodologias ágeis."
                        data-image-src=""> Editar
                </button>
                <button class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 delete-educator-btn" data-id="1">
                  Deletar
                </button>
              </td>
            </tr>
            <tr class="border-b hover:bg-gray-50">
                <td class="p-4 educator-table-id">2</td>
                <td class="p-4 educator-table-name">Jubiscrelton</td>
                <td class="p-4 educator-table-role">jubiscrelton@gmail.com</td>
                <td class="p-4 educator-table-date">29/06/2025</td>
                <td class="p-4 flex space-x-2">
                <button class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded edit-educator-btn"
                        data-id="2"
                        data-name="Prof. Maria Oliveira"
                        data-role="Professora Titular"
                        data-bio="Mestre em Engenharia de Software, especializada em UX/UI Design. Apaixonada por criar interfaces intuitivas e acessíveis para todos os usuários."
                        data-image-src="">
                  Editar
                </button>
                <button class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 delete-educator-btn" data-id="2">
                  Deletar
                </button>
              </td>
            </tr>
            </tbody>
        </table>
      </div>
    </main>
  </div>

  <footer class=" bg-[#001A35] text-white pt-10 pr-5 pb-10 pl-5 text-sm grow">
    </footer>

<script>
    const navLinks = document.querySelector('.nav-links');
    function onToggleMenu(e) {
        e.name = e.name === 'menu' ? 'close' : 'menu';
        navLinks.classList.toggle('top-[62px]');
    }

    // --- CÓDIGO DO MODAL PARA EDUCADORES ---
    const addEducatorBtn = document.getElementById('addEducatorBtn');
    const addEducatorModal = document.getElementById('addEducatorModal');
    const modalPanel = document.getElementById('modalPanel'); 
    const educatorModalTitle = document.getElementById('educatorModalTitle');
    const closeEducatorModalBtn = document.getElementById('closeEducatorModalBtn');
    const cancelEducatorModalBtn = document.getElementById('cancelEducatorModalBtn');
    const saveEducatorBtn = document.getElementById('saveEducatorBtn');
    const addEducatorForm = document.getElementById('addEducatorForm');
    
    const educatorNameInput = document.getElementById('educatorName');
    const educatorRoleInput = document.getElementById('educatorRole');
    const educatorBioInput = document.getElementById('educatorBio');
    const educatorImageInput = document.getElementById('educatorImage');
    const imagePreview = document.getElementById('imagePreview');
    const imagePreviewContainer = document.getElementById('imagePreviewContainer');
    const editingEducatorIdInput = document.getElementById('editingEducatorIdInput'); // Campo oculto

    let currentEditingEducatorId = null; // Para rastrear o ID do educador em edição

    function openModal(educatorToEdit = null) {
        addEducatorForm.reset(); // Limpa o formulário
        editingEducatorIdInput.value = ''; // Limpa ID oculto
        educatorImageInput.value = ''; // Limpa o input de arquivo
        imagePreview.src = '#';
        imagePreviewContainer.classList.add('hidden');
        
        const existingImageText = document.getElementById('currentImageText');
        if (existingImageText) {
            existingImageText.remove();
        }

        if (educatorToEdit) { // Modo Edição
            currentEditingEducatorId = educatorToEdit.id;
            editingEducatorIdInput.value = educatorToEdit.id; // Guarda o ID no campo oculto
            educatorModalTitle.textContent = 'Editar Educador';
            saveEducatorBtn.textContent = 'Salvar Alterações';

            educatorNameInput.value = educatorToEdit.name;
            educatorRoleInput.value = educatorToEdit.role;
            educatorBioInput.value = educatorToEdit.bio;

            if (educatorToEdit.imageSrc && educatorToEdit.imageSrc !== '') {
                imagePreview.src = educatorToEdit.imageSrc;
                imagePreviewContainer.classList.remove('hidden');
                // Adiciona texto informativo sobre a imagem atual
                if (!document.getElementById('currentImageText')) {
                     educatorImageInput.insertAdjacentHTML('afterend', '<small class="block text-xs text-gray-500 mt-1" id="currentImageText">Imagem atual carregada. Para alterar, selecione um novo arquivo.</small>');
                }
            }
        } else { // Modo Adicionar
            currentEditingEducatorId = null;
            educatorModalTitle.textContent = 'Adicionar Novo Educador';
            saveEducatorBtn.textContent = 'Salvar Educador';
        }

        // Animação de entrada do modal
        addEducatorModal.classList.remove('hidden'); 
        void addEducatorModal.offsetWidth; 
        addEducatorModal.classList.remove('bg-opacity-0', 'ease-in');
        addEducatorModal.classList.add('bg-opacity-75', 'ease-out'); 
        modalPanel.classList.remove('opacity-0', 'scale-95', 'ease-in');
        modalPanel.classList.add('opacity-100', 'scale-100', 'ease-out'); 

        if (educatorNameInput) {
            educatorNameInput.focus();
        }
    }

    function closeModal() {
        addEducatorModal.classList.remove('bg-opacity-75', 'ease-out');
        addEducatorModal.classList.add('bg-opacity-0', 'ease-in'); 
        modalPanel.classList.remove('opacity-100', 'scale-100', 'ease-out');
        modalPanel.classList.add('opacity-0', 'scale-95', 'ease-in');

        setTimeout(() => {
            addEducatorModal.classList.add('hidden'); 
            addEducatorForm.reset();
            editingEducatorIdInput.value = '';
            currentEditingEducatorId = null;
            educatorImageInput.value = '';
            imagePreview.src = '#';
            imagePreviewContainer.classList.add('hidden');
            const existingImageText = document.getElementById('currentImageText');
            if (existingImageText) {
                existingImageText.remove();
            }
        }, 300); 
    }

    // Botão "+ Adicionar Educador"
    if (addEducatorBtn) {
        addEducatorBtn.addEventListener('click', () => openModal()); // Chama openModal sem argumentos
    }

    // Botões "Editar" na tabela
    document.querySelectorAll('.edit-educator-btn').forEach(button => {
        button.addEventListener('click', function() {
            const educatorData = {
                id: this.dataset.id,
                name: this.dataset.name,
                role: this.dataset.role,
                bio: this.dataset.bio,
                imageSrc: this.dataset.imageSrc || '' 
            };
            openModal(educatorData); // Chama openModal com os dados do educador
        });
    });

    if (closeEducatorModalBtn) {
        closeEducatorModalBtn.addEventListener('click', closeModal);
    }
    if (cancelEducatorModalBtn) {
        cancelEducatorModalBtn.addEventListener('click', closeModal);
    }
    if (addEducatorModal) {
        addEducatorModal.addEventListener('click', function(event) {
            if (event.target === addEducatorModal) { 
                closeModal();
            }
        });
    }

    if (educatorImageInput && imagePreview && imagePreviewContainer) {
        educatorImageInput.addEventListener('change', function(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    imagePreview.src = e.target.result;
                    imagePreviewContainer.classList.remove('hidden');
                }
                reader.readAsDataURL(file);
            } else {
                // Se o usuário cancelar, e estiver editando e havia imagem anterior, mantém a imagem anterior na prévia
                if (currentEditingEducatorId) {
                    const originalButton = document.querySelector(`.edit-educator-btn[data-id="${currentEditingEducatorId}"]`);
                    if (originalButton && originalButton.dataset.imageSrc) {
                        imagePreview.src = originalButton.dataset.imageSrc;
                        imagePreviewContainer.classList.remove('hidden');
                        return;
                    }
                }
                imagePreview.src = '#';
                imagePreviewContainer.classList.add('hidden');
            }
        });
    }

    if (saveEducatorBtn) {
        saveEducatorBtn.addEventListener('click', function() {
            const name = educatorNameInput.value;
            const role = educatorRoleInput.value;
            const bio = educatorBioInput.value;
            const imageFile = educatorImageInput.files[0]; // Novo arquivo de imagem, se selecionado
            const educatorIdBeingEdited = editingEducatorIdInput.value; // Pega o ID do campo oculto

            if (name.trim() === '' || role.trim() === '' || bio.trim() === '') {
                alert('Por favor, preencha todos os campos obrigatórios: Nome do Educador, Cargo e Biografia.');
                return;
            }

            if (educatorIdBeingEdited) { // Modo Edição
                console.log('Atualizando Educador ID:', educatorIdBeingEdited, { name, role, bio, imageName: imageFile ? imageFile.name : 'Imagem não alterada' });
                alert('Educador "' + name + '" atualizado com sucesso! (Simulação)');

                // Atualizar a linha da tabela (simulação visual)
                const rowToUpdate = document.querySelector(`.edit-educator-btn[data-id="${educatorIdBeingEdited}"]`)?.closest('tr');
                if (rowToUpdate) {
                    rowToUpdate.querySelector('.educator-table-name').textContent = name;
                    rowToUpdate.querySelector('.educator-table-role').textContent = role;
                    // Atualizar data-attributes no botão de editar
                    const editBtn = rowToUpdate.querySelector('.edit-educator-btn');
                    editBtn.dataset.name = name;
                    editBtn.dataset.role = role;
                    editBtn.dataset.bio = bio;
                    // Se uma nova imagem foi salva (simulado), você atualizaria o data-image-src
                    // if (imageFile) { editBtn.dataset.imageSrc = 'novo_caminho_ou_preview_da_imagem_salva'; }
                }

            } else { // Modo Adicionar
                console.log('Novo Educador a ser salvo:', { name, role, bio, imageName: imageFile ? imageFile.name : 'Nenhuma imagem selecionada' });
                alert('Educador "' + name + '" salvo com sucesso! (Simulação)');
                // Aqui você adicionaria uma nova linha à tabela dinamicamente (código não incluído para brevidade)
            }
            
            closeModal(); 
        });
    }
</script>

</body>
</html>